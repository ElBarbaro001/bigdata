from sqlalchemy import create_engine, text
import pymysql
import random

# Crear conexi칩n con la base de datos
try:
    engine = create_engine("mysql+pymysql://root:root@localhost/prueba")
    with engine.connect() as connection:
        # Iniciar transacci칩n
        with connection.begin():
            # Bucle para insertar 5000 registros
            for _ in range(100000):
                # Crear consulta con valores aleatorios
                query = text("""
                    INSERT INTO sensor 
                    VALUES (null, current_timestamp, :v1, :v2, :v3, :v4, :v5, :v6, :v7, :v8, :v9, :v10, :v11, :v12, :v13)
                """)
                
                # Par치metros con valores aleatorios
                params = {f"v{i}": random.randint(1, 100) for i in range(1, 14)}
                
                # Ejecutar consulta
                connection.execute(query, params)

            print("Datos insertados correctamente.")

except Exception as e:
    print(f"Ocurri칩 un error: {e}")
